<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>PHYS1600 Parts</title>
  <style>
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <link rel="stylesheet" href="pandocbd.css" />
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<!---
use 
pandoc --metadata pagetitle="PHYS1600 Parts"  -s --toc -t html5 -c ../../pandocbd.css phys1600_parts.md -o phys1600_parts.html

-->
<h1 id="historical-only">Historical Only</h1>
<p>This page was relavent in the early years of the PHYS1600 course. The parts used have been revised more than once since this page was last updated.</p>
<p>A new page has been created for 2023.</p>
<h2 id="related-pages">Related Pages</h2>
<ul>
<li><p><a href="pic18lf_sound_project.html">pic18lf_sound_project</a> -- moved some “other things of interest” not related to sound from that page to this page.</p></li>
<li><p><a href="https://bitbucket.org/danpeirce/pic18_serial_io" class="uri">https://bitbucket.org/danpeirce/pic18_serial_io</a> -- some basic code for testing the serial/USB interface is on that public page – branches of the project related to specific projects has not been added to that repository.</p></li>
<li><p><a href="hello33.html">hello33</a> even more basic code used to test the USB to UART bridge.</p>
<p>by Dan Peirce</p></li>
</ul>
<p>reformated from <a href="http://danpeirce.net46.net/dokuwiki/doku.php?=phys1600_parts">dokuwiki</a> on July 20, 2013</p>
<h1 id="testing-parts-for-physics-1600">Testing Parts for Physics 1600</h1>
<ol type="1">
<li><p><a href="http://ww1.microchip.com/downloads/en/devicedoc/39626b.pdf">PIC18LF2620</a></p></li>
<li><p><a href="http://www.abra-electronics.com/products/%CE%BCUSB%252dMB5-Breakout-Board-for-CP2102-mini-USB-to-Serial-.html">uUSB-MB5</a> -- this board comes fully assembled as shown. (<a href="usb_mb5.html">note on driver</a>)</p></li>
<li><p><a href="http://www.microchip.com/stellent/idcplg?IdcService=SS_GET_PAGE&amp;nodeId=1406&amp;dDocName=en538340&amp;redirects=pickit3">PICkit3</a></p></li>
</ol>
<p>The uUSB-MB5 provides 3.3Vdc to the PIC18LF2620. The uUSB-MB5 has an on-board 3.3V regulator which converts the USB supplied nominal 5 V to the regulated 3.3volts. The regulator also provides short circuit and thermal protection. It can supply a maximum of 100 mA.</p>
<h2 id="important-note-regarding-using-an-oscilloscope-when-using-the-uusb-mb5">Important Note Regarding Using an Oscilloscope when using the uUSB-MB5</h2>
<p>In APSC1299 the output of the power supply used floats relative to earth ground as long as the PICkit2 is not attached to the circuit. When the uUSB- MB5 is used power comes from the computer USB port. With a desktop computer the negative side of the supply does not float relative to ground. It is grounded. The oscilloscope ground clip is also grounded. Connected the oscilloscope ground clip to anything but the USB ground will cause a short circuit.</p>
<p>The situation is different when using a laptop powered from the battery. In this case the negative side of the supply is floating relative to earth ground. I tested one laptop with the charging power supply plugged in and found the USB ground was still floating.</p>
<h2 id="with-an-external-oscillator">With an External Oscillator</h2>
<p>More than one variant of the supply wiring has been tested. The external Oscillator used in testing</p>
<ul>
<li><a href="http://www.digikey.ca/product-detail/en/MXO45HS-3C-8M0000/CTX743-ND">Digikey Part number CTX743-ND</a></li>
</ul>
<p>This is a five volt oscillator. In this variant of the wiring the positive rail at the bottom of the solderless breadboard is used for 5 V and the positive rail at the top of the breadboard is used for 3.3 volts.</p>
<p>Note that the PIC is tolerant of 5 volt inputs when powered at 3.3 volts! <strong>For student use the jumper wire from 5 volts out of the USB-MB5 could to the nearby power rail could be replaced by a 400 mA axial leaded fuse.</strong></p>
<p><img src="phys1600/usb-mb5_8mhzosc.jpg" /></p>
<p><img src="phys1600/pic_usb-mb5_8mhzosc.jpg" /></p>
<h3 id="alternate-layout-for-5-volt-bus">Alternate Layout for 5 volt Bus</h3>
<p>Rather then use the lower supply bus for 5 volts an alternative is to use just one row for 5 volts and keep both positive rails at 3.3 volts. We would like to minimize the use of the raw 5 volts.</p>
<p><img src="phys1600/alternative_5v_row2.jpg" /></p>
<h3 id="oscillator-on-protoboard-for-short-signal-path">Oscillator on Protoboard for Short Signal Path</h3>
<p>Since the oscillator is at an RF frequency it is a good idea to keep the lead short. Building the oscillator on a little piece of protoboard facilitates this.</p>
<p><img src="phys1600/osc_proto.jpg" /></p>
<p><img src="phys1600/osc_proto_pic.jpg" /></p>
<h3 id="oscillator-protoboard-vertical-for-even-shorter-signal-path">Oscillator Protoboard Vertical for Even Shorter Signal Path</h3>
<p><img src="phys1600/osc_proto_vert.jpg" /></p>
<p><img src="phys1600/osc_proto_pic_vert.jpg" /></p>
<h3 id="signal-from-oscillator">Signal from Oscillator</h3>
<p>Signal from Oscillator when loaded by PIC is shown below. The external oscillator can be used when very precise time measurements are to be made. The internal oscillator is quite adequate for many applications.</p>
<p><img src="phys1600/input_to_osc1_pic.jpg" /></p>
<h3 id="new-branch-on-bitbucket-repository">New Branch on bitbucket repository</h3>
<p>I created a new branch on my git bitbucket repository to reflect the use of an external oscillator.</p>
<ul>
<li><a href="https://bitbucket.org/danpeirce/pic18_serial_io/diff/USARTfunc.c?diff2=9517adf437b4&amp;at=ext_osc">https://bitbucket.org/danpeirce/pic18_serial_io/diff/USARTfunc.c?diff2=9517adf437b4&amp;at=ext_osc</a></li>
</ul>
<p>Screenshot of that link: (the other change not visible in this screen shot was that the call to <strong>set_osc_8MHz()</strong> was commented out in <strong>main.c</strong>.</p>
<p><img src="phys1600/git_bitbucket_change_for_ext_osc.png" /></p>
<h2 id="without-an-external-oscillator">Without an External Oscillator</h2>
<figure>
<img src="phys1600/pic18lf2620_usbmb5_pickit3.jpg" alt="PIC18LF2620 USB-mb5 PICkit3" /><figcaption>PIC18LF2620 USB-mb5 PICkit3</figcaption>
</figure>
<figure>
<img src="phys1600/usb-mb5.jpg" alt="USB-MB5" /><figcaption>USB-MB5</figcaption>
</figure>
<p>In this case I have not used the 5 volt output from the USB-MB5.</p>
<p>&lt;http://www.littelfuse.com/~/media/Files/Littelfuse/Technical%20Resources/Docu ments/Data%20Sheets/Littelfuse_Fuse_251_253_Datasheet.pdf&gt;</p>
<h2 id="test-program">Test Program</h2>
<p>Made use of existing program <strong><a href="https://bitbucket.org/danpeirce/pic18_serial_io">pic18_serial_io</a></strong>. That project was written for the PIC with interacting with a Raspberry Pi in mind but it will interact with a Windows PC just as well. Currently this program recognizes three commands.</p>
<ol type="1">
<li><p>“M” – sends a menu message - this was used for the test.</p></li>
<li><p>“L” – intended to turn on an LED.</p></li>
<li><p>“F” – intended to turn off an LED.</p></li>
</ol>
<p>Note that to test the “L” and “F” commands a 200 ohm resistor should be connected to pin 15 of the PIC and the other end of the resistor should connect to the anode of a LED. The cathode of the LED is connected to ground.</p>
<p>The PIC will also echo any character it receives back over the serial link for a loop-back test. If it receives a ‘ it will add a’’. see <a href="https://bitbucket.org/danpeirce/pic18_serial_io/src/b8c10af1b10d/commands.c" class="uri">https://bitbucket.org/danpeirce/pic18_serial_io/src/b8c10af1b10d/commands.c</a></p>
<p>Complete set of project files can be obtained from <a href="https://bitbucket.org/danpeirce/pic18_serial_io/get/b8c10af1b10d.zip" class="uri">https://bitbucket.org/danpeirce/pic18_serial_io/get/b8c10af1b10d.zip</a>.</p>
<p>Within these files the header file p18f2620.h is used. There is no p18lf2620.h file but from a the programming point of view the devices are equivalent. Also, when the project wizard was used to create the project file the PIC18F2620 device was selected. The resulting HEX file is still suitable for the PIC18LF2620.</p>
<h2 id="terminal-program">Terminal Program</h2>
<p>On Windows XP I used hyperterminal. Windows 7 does not ship with hyperterminal.</p>
<p>I tested <a href="http://www.putty.org/">PuTTY</a>.</p>
<p>I have been using PuTTY as a SSH client but it also works as a simple serial terminal.</p>
<p>This screen shot shows a PuTTY session connected to the PIC18LF2620 via the USB to serial bridge uUSB-MB5:</p>
<p>Note that the PuTTY terminal screen will be empty until something is typed on the computer (laptop). What ever is typed will be echoed to the screen (by the PIC) if everything is set-up correctly. Typing “m” sends the menu message (from the PIC): <img src="phys1600/putty_laptop_desktop.png" /></p>
<h3 id="putty-settings">PuTTY Settings</h3>
<p>The following screen shots show the PuTTY settings:</p>
<p><strong>PuTTY -&gt; Connection -&gt; Serial</strong> <img src="phys1600/putty_connection.png" /></p>
<p><strong>PuTTY -&gt; Window -&gt; Colours</strong><br />
Select <strong>Use System Colours</strong> to avoid getting white on black. <img src="phys1600/putty_window_colours.png" /></p>
<p><strong>PuTTY -&gt; Session</strong><br />
Connection type must be selected as <strong>Serial</strong> <img src="phys1600/putty_session.png" /></p>
<h2 id="getting-the-pickit3-to-work-with-the-pic18lf2620">Getting the PICkit3 to work with the PIC18LF2620</h2>
<h3 id="with-pickit3-pin-2-to-3.3-volt-connection">With PICkit3 Pin 2 to 3.3 Volt Connection</h3>
<p>Please note that when this was tested the connections between the PICkit3 and the PIC18LF2620 were as follows:</p>
<p><img src="phys1600/pickit3_connections.png" /></p>
<p>I am working on a plastic bracket with the intention of having it 3D printed. See <a href="https://github.com/danpeirce/bracket-breadboard#purpose-of-the-bracket-breadboard-scad-project">https://github.com/danpeirce/bracket-breadboard#purpose-of-the-bracket-breadboard-scad-project</a></p>
<p><img src="phys1600/pickit3_on_connect.png" /></p>
<p>Once the <strong>OK</strong> is selected the device ID will be shown:</p>
<pre><code>      Device ID Revision = 00000007</code></pre>
<p>It is possible to read the source voltage:</p>
<p><img src="phys1600/pickit3_reading_voltage.png" /></p>
<p>If the PICkit3 pin2 is connected to the circuit and the circuit is powered from the USB connection it is essentially that Powering from the PICkit3 is not checked on the power tab!</p>
<h3 id="with-pickit3-pin-2-left-no-connection">With PICkit3 Pin 2 Left No Connection</h3>
<p>With the PICkit2 we left the power connection open because we did not plan to power the board from the PICkit2 and it seemed to avoid the possible issue of someone inadvertently powering the board from the PICkit2. With the PICkit3 we still don’t want to power our board from the PICkit3 (and risk damage to it). It appears that with the PICkit3 it would not be easy to power the board from the PICkit3 unintentionally and as shown below leaving PIN2 open leads to many extra steps being necessary. <strong>This part is included for completeness – For the PICkit3 I recomend adding the wire from PIN2 to VDD.</strong></p>
<p>Note that a PICkit2 will attempt to read the voltage on its pin2. If no voltage is pressent the firmware will assume that the target needs to be powered from the PICkit2’s supply. It appears that the firmware on the PICkit3 is different. If no voltage is sensed on pin2 it will give the following error:</p>
<pre><code>        PK3Err0045: You must connect a target device to use PICkit3.</code></pre>
<p>Perhaps a better error message would have said that no voltage was detected. One could use a wire from the board positive rail to the PICkit3 pin2 or one could use the following procedure which I worked out by trial and error.</p>
<p><strong>The error:</strong></p>
<p><img src="phys1600/error_on_connect.png" /></p>
<p>Select <strong>Programmer -&gt; Settings</strong></p>
<p><img src="phys1600/programmer_settings.png" /></p>
<p>Select the <strong>Power</strong> tab and set the voltage to <strong>3.375 volts</strong> by dragging the slider. Also, ensure that the <strong>Power target circuit from PICkit3</strong> check box is checked! When that is all done click on <strong>apply</strong>.</p>
<p><img src="phys1600/power_setting.png" /></p>
<p>A warning message will pop up. It will say the same thing regardless if the voltage has been shifted down to 3.375 volts or not. The dialog box can be moved around so check that the voltage is set to 3.375. The checking is not essential if Pin2 of the PICkit3 is not actually connected to anything! Click on <strong>OK</strong>.</p>
<p><img src="phys1600/voltage_caution.png" /></p>
<p>The PICkit3 firmware progresses and says shows the <strong>Device ID Revision = 00000007</strong>. At this point the MPlab IDE tools for interacting with the PIC device become viable, contain color and are responsive so the device can now be programmed.</p>
<p><img src="phys1600/device_id.png" /></p>
<p>Once printed the error message does not go away (unless it scrolls up out of view) but the new line with the device id is an indication that the MPlab IDE is now talking to the PIC18LF device.</p>
<p><img src="phys1600/programming_tools.png" /></p>
<h2 id="for-standalone-projects">For Standalone Projects</h2>
<p>In Phys1600 there will be some projects which are standalone. In these cases power from a USB port will not be available and a computer will not be available to display results. In those cases battery power will be needed. The LCD module that we typically use requires 5 VDC (the LCD is not required when attached to a laptop since we can run a terminal program on the laptop).</p>
<p>I found a suitable DC-DC converter that can provide a regulated 5 Volts out even when the input voltage is substantially less than 5 volts. See <a href="dc_to_dc_converter.html">dc_to_dc_converter</a>.</p>
<h2 id="other-things-of-interest">Other things of Interest</h2>
<h3 id="pic32-devices-and-the-xc32-compiler">PIC32 Devices and the XC32 Compiler</h3>
<p>I have just started to look into the documentation of the PIC32 devices and the XC32 Compiler as of September 8, 2013.</p>
<h4 id="pic32-devices">PIC32 Devices</h4>
<p>There are a few DIP versions of PIC32 devices and the price is actually lower than the PIC18 device we have been using!</p>
<ul>
<li>PIC32MX150F128B-I/SP - just $4.67 at digikey (the PIC18F2620 is actually $6.91)</li>
<li><a href="http://ww1.microchip.com/downloads/en/DeviceDoc/61168E.pdf">datasheet - PIC32MX150F128B-I/SP</a></li>
</ul>
<h4 id="xc32-compiler">XC32 Compiler</h4>
<ul>
<li><a href="http://ww1.microchip.com/downloads/en/DeviceDoc/XC32-v121-ReleaseNotes.html#Document" class="uri">http://ww1.microchip.com/downloads/en/DeviceDoc/XC32-v121-ReleaseNotes.html#Document</a></li>
<li><a href="http://ww1.microchip.com/downloads/en/DeviceDoc/51686F.pdf">MPLAB XC32 C Compieler User’s Guide</a> – note that <strong>page 10</strong> contains <strong>recomended reading</strong></li>
</ul>
<p>The XC32 compiler is a port of the GNU GCC compiler and is covered by the GPL. The functions in the hardware library are specific to Microchip devices and they are not covered by the GPL.</p>
<h3 id="tft-lcd">TFT LCD</h3>
<p>4D Systems makes small TFT LCDs with full color, built-in controller, sound, touch screen and SD-card interface. They package some in kits complete with serial interface to a raspberry pi. The displays could also be used with a microchip PIC.</p>
<p>See <a href="4d_lcd.html">4D_LCD</a></p>
<h3 id="keypad">Keypad</h3>
<p>I have been looking at keypads. It appears one can get much better value purchasing a 3by4 keypad rather than a 4by4 keypad. It would actually be cheaper to have two 3by4 keypads on a project than one 4by4 so I’d recomend getting the 3by4. I expect the 3by4 ones are less expensive because they are sutiable for telephones.</p>
<p>this one looks like a good deal from a Canadian source:</p>
<ul>
<li><a href="http://www.solarbotics.com/product/50847/" class="uri">http://www.solarbotics.com/product/50847/</a></li>
</ul>
<h3 id="mems-microphone">MEMS Microphone</h3>
<p><a href="http://www.sparkfun.com/products/9868">Breakout Board for ADMP401 MEMS Microphone</a> -- I used to think the <a href="http://www.sparkfun.com/products/8635">Electret Microphones</a> were small. This mems Microphone board contains the microphone and op amp circuit. The entire board with through hole solder pads is about the same size as an electret microphone. – --<a href="http://www.memsjournal.com/2011/03/overview-of-mems-microphone-%20technologies-for-consumer-applications.html">Overview of MEMS microphone technologies for consumer applications</a></p>
<h3 id="breakout-board-for-sc16is750-i2cspi-to-uart-ic">Breakout Board for SC16IS750 I2C/SPI-to-UART IC</h3>
<p><a href="http://www.sparkfun.com/products/9981">Breakout Board for SC16IS750 I2C/SPI-to-UART IC</a> -- while this is a real interesting little board and one could gain an extra USART interface, it would actually cost less and gain more functionality to connect to another PIC18LF2620!</p>
<h3 id="breakout-board-for-sd-mmc-cards">Breakout Board for SD-MMC Cards</h3>
<p><strong>Looks like this sparkfun breakout board has been discontinued.</strong> <a href="http://www.sparkfun.com/products/204">Breakout Board for SD-MMC Cards</a> -- “With SD and MMC memory prices dropping, the time is right for mass storage and datalogging. This breakout board will allow you to breakout the SD/MMC socket to a standard .1” 11-pin header. Perfect for breadboarding and the likes. Board comes fully assembled and tested as shown." see <a href="http://www.maxim-ic.com/app-notes/index.mvp/id/3969" class="uri">http://www.maxim-ic.com/app-notes/index.mvp/id/3969</a></p>
<p><a href="http://www.solarbotics.com/product/13200/" class="uri">http://www.solarbotics.com/product/13200/</a> <strong>Looks like this one costs less and has more on it (changed link as old link was broken Nov. 21, 2012 – nothing stands still).</strong> Also, this is from a Canadian source.</p>
<p>Links to <a href="http://site.gravitech.us/MicroResearch/Others/SD-ADP/SDmanual.pdf" class="uri">http://site.gravitech.us/MicroResearch/Others/SD-ADP/SDmanual.pdf</a></p>
<h3 id="volt-8-mhz-crystal">3.3 volt 8 MHz Crystal</h3>
<p><a href="http://www.digikey.ca/product-detail/en/CB3LV-3C-8M0000/CTX264LVCT-ND/280258" class="uri">http://www.digikey.ca/product-detail/en/CB3LV-3C-8M0000/CTX264LVCT-ND/280258</a></p>
<ul>
<li><a href="http://www.ctscorp.com/components/Datasheets/008-0256-0_F.pdf" class="uri">http://www.ctscorp.com/components/Datasheets/008-0256-0_F.pdf</a></li>
</ul>
<h3 id="line-in-vs-mic-input-of-pc">Line in vs Mic input of PC</h3>
<ul>
<li><a href="http://circuits.radio-electronics.co/audio/speakers-systems/line-level-signal-to-microphone-input-adapter/" class="uri">http://circuits.radio-electronics.co/audio/speakers-systems/line-level-signal-to-microphone-input-adapter/</a></li>
</ul>
</body>
</html>
